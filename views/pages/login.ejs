<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Login</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="crossorigin="anonymous"></script>
  <script src="\customjs\shared.js"></script>

</head>
<body class="container">
<header class="page-header">
  <h1>Login</h1>
</header>
<main>
  <section>
  <!-- if message sent from the router directly -->
      <% if (typeof message !== 'undefined') { %>
      <div class="alert alert-danger" role="alert" ><%= message %></div>
    <% } %>
    <div class="alert alert-danger" role="alert" id="errorMessage" style="display:none"></div>
    <form class="form">
    <div class="form-group">
      <label for="email">Email</label>
      <input type="email" class="form-control" id="email" placeholder="Enter your email" required>
    </div>
    <div class="form-group">
      <label for="email">Password</label>
      <input type="password" class="form-control" id="password" placeholder="Enter your password" required>
    </div>
    <button type="submit" class="btn btn-default btn-success">
    Login
    </button>
    </form>
  </section>
</main>

<script>
  
  $(() => {
    $('form').submit((event) => {
      event.preventDefault();
      const user = getUserFromForm();

      login(user)
        .then(result => {
          console.log(result);
          window.location = '/map';
        }).catch(error => {
          showErrorMessage(error.responseJSON.message);
        })
    });
  });

function login(user) {
  return $.post(`http://localhost:4321/auth/login`, user)
}


</script>

</body>
</html>